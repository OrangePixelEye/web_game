(()=>{"use strict";var t={523:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=s(657);e.default=class{constructor(){this.playing_music=new Audio("./music.wav")}play(){const t=Number(i.SaveSystem.load("volume"));this.playing_music.volume=NaN==t?1:t,this.playing_music.loop=!0,this.playing_music.play()}stop(){this.playing_music.pause()}}},41:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UI=void 0;const i=s(623),o=s(523),n=s(657);class a{constructor(){this.btn_play=document.getElementById("p"),this.btn_settings=document.getElementById("settings"),this.btn_credits=document.getElementById("c"),this.btn_exit=document.getElementById("e"),this.btn_menu=document.getElementById("menu"),this.btn_play_again=document.getElementById("play_again"),this.btn_back_to_menu=document.getElementsByName("back_menu"),this.btn_reset_points=document.getElementById("configure-reset"),this.range_audio=document.getElementById("configure-music"),this.btn_controls=document.getElementById("controls-start"),a.showUI(document.getElementById("canvas"),!1),this.configureUI()}updateElementText(t,e){t.innerText=e}updateElementRange(t,e){t.value=e}configureUI(){this.updateElementText(this.btn_reset_points,"Reset highscore: "+n.SaveSystem.load("points")),this.btn_settings.onclick=()=>{a.showMenu("allthethings","ui-settings")},this.range_audio.oninput=t=>{n.SaveSystem.save("volume",t.target.value)},this.btn_credits.onclick=()=>{a.showMenu("allthethings","ui-credits")},this.btn_play.onclick=()=>{if(""===n.SaveSystem.load("first"))return n.SaveSystem.save("first","no"),void a.showMenu("allthethings","ui-controls");a.showMenu("allthethings","canvas"),r()},this.btn_reset_points.onclick=()=>{const t=new Map([["points","0"],["volume","1"],["first",""]]);n.SaveSystem.saveArray(t),this.updateElementRange(document.getElementById("configure-music"),.5),this.updateElementText(this.btn_reset_points,"Reset highscore: "+n.SaveSystem.load("points"))},this.btn_play_again.onclick=()=>{a.showMenu("game_over","canvas"),r()},this.btn_menu.onclick=()=>{a.showMenu("game_over","allthethings")},this.btn_controls.onclick=()=>{a.showMenu("ui-controls","canvas"),r()},this.btn_exit.onclick=()=>{close()},this.btn_back_to_menu.forEach((t=>{t.onclick=t=>{let e="ui-";e+=t.target.dataset.screen,a.showMenu(e,"allthethings")}}))}static reconfigureUI(){(new a).configureUI()}static showUI(t,e){t.style.display=e?"":"none"}static showMenu(t,e){a.reconfigureUI(),a.showUI(document.getElementById(t),!1),a.showUI(document.getElementById(e),!0)}}let h;function r(){h.init_game(),h.main()}e.UI=a,h=new i.Game(500,500,new o.default),h.state=i.GameState.playing,new a},283:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Controls=void 0,e.Controls=class{constructor(){this.codes={37:"left",32:"forward"},this.states={left:!1,forward:!1},document.addEventListener("keydown",this.onKey.bind(this,!0),!1),document.addEventListener("keyup",this.onKey.bind(this,!1),!1)}onKey(t,e){var s=this.codes[e.keyCode];void 0!==s&&(this.states[s]=t,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())}}},623:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Game=e.GameState=void 0;const i=s(657),o=s(575),n=s(237),a=s(283),h=s(41);var r;!function(t){t[t.playing=0]="playing",t[t.lose=1]="lose"}(r=e.GameState||(e.GameState={}));class c{constructor(t,e,s){this.appendBlock=t=>this.ground_blocks.push(t),this.main=()=>this.run(),this.calculatePoints=()=>this.roundUp(this.points/90,2),this.height=t,this.width=e,this.canvas=document.createElement("canvas"),this.canvas.id="canvas",this.canvas.width=e,this.canvas.height=t,this.canvas.style.border="1px solid #000",this.ctx=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.ctx.font="35px serif",this.music_player=s,this.bg=document.getElementById("bg")}init_game(){this.ground_blocks=[new n.GroundBlock(this.ctx,0,240,500,20,"ABC")],this.high_score=i.SaveSystem.load("points"),this.obstacles=this.ground_blocks[0].obstacles,this.appendBlock(new n.GroundBlock(this.ctx,570,240,100,20,"ABC")),this.obstacles=this.obstacles.concat(this.ground_blocks[1].obstacles),this._player=new o.Player(this.ctx,new a.Controls),this.state=r.playing,this.points=0,this.music_player.play()}get player(){return this._player}static detectCollision(t,e){try{return!(t.y+t.height<e.y||t.y>e.y+e.height||t.x+t.width<e.x||t.x>e.x+e.width)}catch(t){throw"Bloco não encontrado"}}update(){this.points++,this._player.update(),this.verifyCollisions(),this.updateMap()}updateMap(){this.ground_blocks.forEach((t=>{if(t.update(),!t.insideScreen()){for(let e=0;e<t.obstacles.length;e++)this.obstacles.shift();this.ground_blocks.shift(),this.generateNewBlock()}})),this.obstacles.forEach((t=>t.update())),this._player.is_colliding=c.detectCollision(this._player,this.ground_blocks[0])}generateNewBlock(){this.appendBlock(new n.GroundBlock(this.ctx,this.ground_blocks[this.ground_blocks.length-1].x+280,240,Math.floor(190*Math.random())+50,20,"FFF")),this.obstacles=this.obstacles.concat(this.ground_blocks[this.ground_blocks.length-1].obstacles)}verifyCollisions(){void 0!==this.obstacles&&this.obstacles.forEach((t=>{c.detectCollision(t,this._player)&&(this.state=r.lose)}))}draw_background(){this.ctx.drawImage(this.bg,0,0,500,500)}draw(){this.draw_background(),this.obstacles.forEach((t=>t.draw())),this.drawGround(),this._player.draw()}drawGround(){this.ground_blocks.forEach((t=>{t.draw()}))}run(){this.state==r.playing&&(this.update(),this.draw(),this.drawUI(this.state),window.requestAnimationFrame((()=>this.run())))}drawUI(t){switch(t){case r.playing:this.updateScreenPoints(this.points),this.showHighscore();break;case r.lose:this.gameOver();break;default:throw"Undefined status"}}showHighscore(){this.ctx.fillStyle="orange",this.ctx.fillText("HI:  "+this.high_score,25,40)}updateScreenPoints(t){this.ctx.fillStyle="orange",this.ctx.fillText(t.toString(),25,90)}gameOver(){let t=this.points.toString();window.cancelAnimationFrame(0),h.UI.showMenu("canvas","game_over"),Number(i.SaveSystem.load("points"))<this.points&&(i.SaveSystem.save("points",this.points),t+=" é um novo record !"),document.getElementById("points").innerText=t,this.music_player.stop()}roundUp(t,e){return e=Math.pow(10,e),Math.ceil(t*e)/e}}e.Game=c},237:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GroundBlock=void 0;const i=s(202),o=s(728);class n extends i.MoveableDrawable{constructor(t,e,s,i,o,n,a=3.3){super(t,e,s,i,o),this.color="#"+n,this.speed=a,this.generateRandomObstacles()}generateRandomObstacles(){Math.floor(1*Math.random()),this.obs=[new o.Obstacles(this.ctx,Math.floor(13*Math.random())+this.x+45,this.y+10,13,15,"FFF",this.speed)]}chooseRandomPosition(t){return Math.floor(Math.random()*t)}get obstacles(){return this.obs}insideScreen(){return this.x>-this.width}}e.GroundBlock=n},202:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MoveableDrawable=void 0,e.MoveableDrawable=class{constructor(t,e,s,i,o,n){this.ctx=t,this.x=e,this.y=s,this.width=i,this.height=o,this.color=n,void 0===this.color&&(this.color="#FFFFFF")}update(){this.x-=this.speed}draw(){this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y,this.width,this.height)}}},728:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Obstacles=void 0;const i=s(202);class o extends i.MoveableDrawable{constructor(t,e,s,i,o=0,n,a){super(t,e,s,i,o),this.height=this.randomHeight(),this.y=this.randomY(this.height),this.speed=a,this.img=document.getElementById("spike")}randomHeight(){return Math.floor(41*Math.random())+20}randomY(t){return Math.floor(Math.random()>.5?0:-t)+250}draw(){this.ctx.drawImage(this.img,this.x,this.y,this.width,this.height)}}e.Obstacles=o},575:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0,e.Player=class{constructor(t,e){this.jump_force=15.6,this.gravity=.6,this.vertical_speed=0,this.can_jump=!1,this.is_colliding=!1,this.ctx=t,this.direction=!0,this.x=50,this.y=0,this.width=30,this.height=30,this.controls=e}update(){this.calcGravity(),this.groundCollision(),this.getInput()}draw(){this.ctx.fillStyle="orange",this.ctx.fillRect(this.x,this.y,this.width,this.height)}jump(){this.is_colliding&&(this.vertical_speed=-this.jump_force)}invert(){this.vertical_speed-=this.jump_force,this.direction=!this.direction}getInput(){this.controls.states.forward&&this.jump()}calcGravity(){this.vertical_speed+=this.gravity,this.y=this.direction?this.y+this.vertical_speed:this.y-this.vertical_speed}groundCollision(){(this.y>250-this.height&&this.direction||this.y<259&&!this.direction)&&this.is_colliding&&(this.can_jump=!0,this.y=this.direction?240-this.height:260),this.y>300&&this.direction&&this.invert(),this.y<200&&!this.direction&&this.invert()}}},657:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SaveSystem=void 0,e.SaveSystem=class{static saveArray(t){t.forEach(((t,e)=>{localStorage.setItem(e,t)}))}static save(t,e){localStorage.setItem(t,e)}static load(t){var e;return null!==(e=localStorage.getItem(t))&&void 0!==e?e:""}}}},e={};!function s(i){var o=e[i];if(void 0!==o)return o.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}(41)})();